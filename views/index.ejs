<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head') -%>
  <body>
    <header>
      <h1>File Metadata API</h1>
      <p>Created by <a href="https://autumnbullard-portfolio.herokuapp.com" target="_blank">Autumn Bullard</a> &copy; <%= new Date().getFullYear(); %></p>
    </header>
    <main>
      <p>My project for the <a href="https://learn.freecodecamp.org/apis-and-microservices/apis-and-microservices-projects/file-metadata-microservice" target="_blank">File Metadata Microservice challenge</a> as part of the curriculum for the Apis and Microservices Certification on <a href="https://www.freecodecamp.org" target="_blank">freeCodeCamp</a>.</p>
      <p>View the <a href="https://github.com/autumnchris/file-metadata-api" target="_blank">source code</a> for this project.</p>
      <hr>
      <section>
        <h2>Project Usage</h2>
        <p>Upload a file in the form below to get the corresponding data for the file name, file type, and file size (in bytes).</p>
        <form class="file-upload-form" action="/api/fileanalyse" method="post" enctype="multipart/form-data">
          <div class="form-group file-group">
            <input type="file" class="file-upload-input" name="upfile" id="file-upload-input">
            <label class="button file-upload-label" for="file-upload-input" id="file-upload-label">Select a File</label>
            <p class="file-upload-file-name">No file selected</p>
          </div>
          <input type="submit" class="button" value="Submit">
        </form>
      </section>
    </main>
    <script>
      const fileInput = document.getElementById('file-upload-input');
      const formErrorMessage = document.createElement('p');
      formErrorMessage.classList.add('message', 'error-message');
      formErrorMessage.innerHTML = `<span class="fa fa-exclamation-circle fa-lg fa-fw"></span> Please select a file to submit the form.`;
      let fileNameMessage = 'No file selected';

      document.getElementById('file-upload-input').addEventListener('change', event => {
        event.target.files.length ? fileNameMessage = event.target.files[0].name : fileNameMessage = 'No file selected';
        document.querySelector('.file-upload-file-name').innerHTML = fileNameMessage;
      }, false);

      document.querySelector('.file-upload-form').addEventListener('submit', event => {

        if (fileNameMessage === 'No file selected') {
          event.preventDefault();
          document.querySelector('main section').appendChild(formErrorMessage);
        }
      });
    </script>
  </body>
</html>
